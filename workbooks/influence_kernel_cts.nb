(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     10631,        323]
NotebookOptionsPosition[      9656,        284]
NotebookOutlinePosition[      9994,        299]
CellTagsIndexPosition[      9951,        296]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
We devise Ogata-style nonparametric kernels
\
\>", "Input",
 CellChangeTimes->{{3.674444702999682*^9, 3.674444743201763*^9}, 
   3.677377515529984*^9},
 FormatType->"TextForm"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"t", "^", "k"}], "*", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "c"}], "*", "t"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "\[Infinity]"}], "}"}], ",", 
   RowBox[{"Assumptions", "->", 
    RowBox[{
     RowBox[{"c", ">", "0"}], "&&", 
     RowBox[{"k", "\[Element]", "Integers"}], "&&", 
     RowBox[{"k", ">=", "0"}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.674444737197958*^9, 3.674444760170183*^9}, {
  3.674444796362503*^9, 3.6744448679175043`*^9}, {3.674444927347453*^9, 
  3.6744450495211153`*^9}},
 FormatType->"InputForm"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["c", 
   RowBox[{
    RowBox[{"-", "1"}], "-", "k"}]], " ", 
  RowBox[{"Gamma", "[", 
   RowBox[{"1", "+", "k"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.6744448434883137`*^9, 3.6744448685914917`*^9}, {
  3.674445026335198*^9, 3.6744450506165867`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"lagkern", "[", 
   RowBox[{"t_", ",", "k_", ",", "c_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"t", "^", "k"}], "*", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "c"}], "*", "t"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["c", 
       RowBox[{
        RowBox[{"-", "1"}], "-", "k"}]], " ", 
      RowBox[{"Gamma", "[", 
       RowBox[{"1", "+", "k"}], "]"}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.674445406090753*^9, 3.674445477401169*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"lagkern", "[", 
      RowBox[{"t", ",", 
       RowBox[{"k", "^", "2"}], ",", 
       RowBox[{"1", "/", "3"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "200"}], "}"}]}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"k", ",", "0", ",", "10", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6744454863048763`*^9, 3.6744455971125593`*^9}, {
  3.674445837323215*^9, 3.674445859530699*^9}, {3.674446040858841*^9, 
  3.674446079900914*^9}, {3.674449135386653*^9, 3.674449166615511*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`k$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`k$$], 0, 10, 1}}, Typeset`size$$ = {
    360., {103., 108.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`k$16899$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`k$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`k$$, $CellContext`k$16899$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Plot[
        $CellContext`lagkern[$CellContext`t, $CellContext`k$$^2, 1/
         3], {$CellContext`t, 0, 200}], 
      "Specifications" :> {{$CellContext`k$$, 0, 10, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{407., {147., 154.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.674445860143956*^9, 3.6744459247921257`*^9, {3.67444601352748*^9, 
   3.6744460805394983`*^9}, {3.674449136915947*^9, 3.67444916740278*^9}}]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.674445386420164*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"t", "^", "k"}], "*", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "c"}], "*", "t"}], "]"}]}], ",", "t"}], "]"}], "==", 
   "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.6744461507230673`*^9, 3.674446198366008*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"t", "\[Rule]", 
    FractionBox["k", "c"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.674446169171278*^9, 3.6744461987867403`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"lagkern", "[", 
     RowBox[{"t", ",", "k", ",", "c"}], "]"}], "*", "t"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "\[Infinity]"}], "}"}], ",", 
   RowBox[{"Assumptions", "->", 
    RowBox[{
     RowBox[{"c", ">", "0"}], "&&", 
     RowBox[{"k", "\[Element]", "Integers"}], "&&", 
     RowBox[{"k", ">=", "0"}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.674446242305956*^9, 3.674446284740837*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"1", "+", "k"}], "c"]], "Output",
 CellChangeTimes->{{3.674446272350628*^9, 3.674446285328826*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"lagkern", "[", 
       RowBox[{"t", ",", "k", ",", "c"}], "]"}], "*", 
      RowBox[{"t", "^", "2"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "\[Infinity]"}], "}"}], ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{
       RowBox[{"c", ">", "0"}], "&&", 
       RowBox[{"k", "\[Element]", "Integers"}], "&&", 
       RowBox[{"k", ">=", "0"}]}]}]}], "]"}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "k"}], ")"}], "/", "c"}], ")"}], "^", "2"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.674446963162653*^9, 3.6744469665952063`*^9}, {
  3.674448725903802*^9, 3.6744487333760233`*^9}, {3.674448763908515*^9, 
  3.674448767515338*^9}, {3.674448811330306*^9, 3.674448818078347*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"1", "+", "k"}], 
  SuperscriptBox["c", "2"]]], "Output",
 CellChangeTimes->{3.674448818295128*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"lagkern", "[", 
        RowBox[{"t", ",", 
         RowBox[{"k", "^", "2"}], ",", "c"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "20"}], "}"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "200"}], "}"}]}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"c", ",", "0.1", ",", "3", ",", " ", "0.1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.674449313075491*^9, 3.674449462623317*^9}, {
  3.674449505086919*^9, 3.674449548747533*^9}, {3.6744496606263227`*^9, 
  3.674449661054968*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`c$$ = 0.1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`c$$], 0.1, 3, 0.1}}, Typeset`size$$ = {
    360., {103., 108.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`c$25425$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`c$$ = 0.1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`c$$, $CellContext`c$25425$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Plot[
        Sum[
         $CellContext`lagkern[$CellContext`t, $CellContext`k^2, \
$CellContext`c$$], {$CellContext`k, 1, 20}], {$CellContext`t, 0, 200}], 
      "Specifications" :> {{$CellContext`c$$, 0.1, 3, 0.1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{407., {147., 154.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.674449375424285*^9, 3.674449466889937*^9}, {
   3.6744495068295603`*^9, 3.6744495492725687`*^9}, 3.674449662496488*^9}]
}, Open  ]]
},
WindowSize->{1185, 782},
WindowMargins->{{323, Automatic}, {Automatic, 102}},
FrontEndVersion->"10.1 for Linux x86 (64-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 186, 6, 50, "Input"],
Cell[CellGroupData[{
Cell[769, 30, 654, 18, 32, "Input"],
Cell[1426, 50, 295, 8, 35, "Output"]
}, Open  ]],
Cell[1736, 61, 533, 17, 41, "Input"],
Cell[CellGroupData[{
Cell[2294, 82, 632, 15, 32, "Input"],
Cell[2929, 99, 1770, 36, 318, "Output"]
}, Open  ]],
Cell[4714, 138, 87, 1, 55, "Input"],
Cell[CellGroupData[{
Cell[4826, 143, 347, 11, 32, "Input"],
Cell[5176, 156, 194, 5, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5407, 166, 493, 13, 32, "Input"],
Cell[5903, 181, 137, 3, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6077, 189, 882, 24, 32, "Input"],
Cell[6962, 215, 137, 4, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7136, 224, 701, 19, 32, "Input"],
Cell[7840, 245, 1800, 36, 318, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
