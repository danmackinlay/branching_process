(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     13386,        417]
NotebookOptionsPosition[     12087,        367]
NotebookOutlinePosition[     12446,        383]
CellTagsIndexPosition[     12403,        380]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[StyleBox["Ogata-style nonparametric kernels\n", "Chapter"]], \
"Input",
 CellChangeTimes->{{3.674444702999682*^9, 3.674444743201763*^9}, 
   3.677377515529984*^9, {3.697766887470274*^9, 3.697766901639874*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"t", "^", "k"}], "*", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "c"}], "*", "t"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "\[Infinity]"}], "}"}], ",", 
   RowBox[{"Assumptions", "->", 
    RowBox[{
     RowBox[{"c", ">", "0"}], "&&", 
     RowBox[{"k", "\[Element]", "Integers"}], "&&", 
     RowBox[{"k", ">=", "0"}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.674444737197958*^9, 3.674444760170183*^9}, {
  3.674444796362503*^9, 3.6744448679175043`*^9}, {3.674444927347453*^9, 
  3.6744450495211153`*^9}},
 FormatType->"InputForm"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["c", 
   RowBox[{
    RowBox[{"-", "1"}], "-", "k"}]], " ", 
  RowBox[{"Gamma", "[", 
   RowBox[{"1", "+", "k"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.6744448434883137`*^9, 3.6744448685914917`*^9}, {
  3.674445026335198*^9, 3.6744450506165867`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"lagkern", "[", 
   RowBox[{"t_", ",", "k_", ",", "c_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"t", "^", "k"}], "*", 
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "c"}], "*", "t"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["c", 
       RowBox[{
        RowBox[{"-", "1"}], "-", "k"}]], " ", 
      RowBox[{"Gamma", "[", 
       RowBox[{"1", "+", "k"}], "]"}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.674445406090753*^9, 3.674445477401169*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"lagkern", "[", 
      RowBox[{"t", ",", 
       RowBox[{"k", "^", "2"}], ",", 
       RowBox[{"1", "/", "3"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "200"}], "}"}]}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"k", ",", "0", ",", "10", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6744454863048763`*^9, 3.6744455971125593`*^9}, {
  3.674445837323215*^9, 3.674445859530699*^9}, {3.674446040858841*^9, 
  3.674446079900914*^9}, {3.674449135386653*^9, 3.674449166615511*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`k$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`k$$], 0, 10, 1}}, Typeset`size$$ = {
    360., {104., 109.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`k$16899$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`k$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`k$$, $CellContext`k$16899$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Plot[
        $CellContext`lagkern[$CellContext`t, $CellContext`k$$^2, 1/
         3], {$CellContext`t, 0, 200}], 
      "Specifications" :> {{$CellContext`k$$, 0, 10, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{405., {148., 153.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.674445860143956*^9, 3.6744459247921257`*^9, {3.67444601352748*^9, 
   3.6744460805394983`*^9}, {3.674449136915947*^9, 3.67444916740278*^9}}]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.674445386420164*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"t", "^", "k"}], "*", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "c"}], "*", "t"}], "]"}]}], ",", "t"}], "]"}], "==", 
   "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.6744461507230673`*^9, 3.674446198366008*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"t", "\[Rule]", 
    FractionBox["k", "c"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.674446169171278*^9, 3.6744461987867403`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"lagkern", "[", 
     RowBox[{"t", ",", "k", ",", "c"}], "]"}], "*", "t"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "\[Infinity]"}], "}"}], ",", 
   RowBox[{"Assumptions", "->", 
    RowBox[{
     RowBox[{"c", ">", "0"}], "&&", 
     RowBox[{"k", "\[Element]", "Integers"}], "&&", 
     RowBox[{"k", ">=", "0"}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.674446242305956*^9, 3.674446284740837*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"1", "+", "k"}], "c"]], "Output",
 CellChangeTimes->{{3.674446272350628*^9, 3.674446285328826*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"lagkern", "[", 
       RowBox[{"t", ",", "k", ",", "c"}], "]"}], "*", 
      RowBox[{"t", "^", "2"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "\[Infinity]"}], "}"}], ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{
       RowBox[{"c", ">", "0"}], "&&", 
       RowBox[{"k", "\[Element]", "Integers"}], "&&", 
       RowBox[{"k", ">=", "0"}]}]}]}], "]"}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "k"}], ")"}], "/", "c"}], ")"}], "^", "2"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.674446963162653*^9, 3.6744469665952063`*^9}, {
  3.674448725903802*^9, 3.6744487333760233`*^9}, {3.674448763908515*^9, 
  3.674448767515338*^9}, {3.674448811330306*^9, 3.674448818078347*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"1", "+", "k"}], 
  SuperscriptBox["c", "2"]]], "Output",
 CellChangeTimes->{3.674448818295128*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"lagkern", "[", 
        RowBox[{"t", ",", 
         RowBox[{"k", "^", "2"}], ",", "c"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "20"}], "}"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "200"}], "}"}]}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"c", ",", "0.1", ",", "3", ",", " ", "0.1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.674449313075491*^9, 3.674449462623317*^9}, {
  3.674449505086919*^9, 3.674449548747533*^9}, {3.6744496606263227`*^9, 
  3.674449661054968*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`c$$ = 0.1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`c$$], 0.1, 3, 0.1}}, Typeset`size$$ = {
    360., {104., 109.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`c$25425$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`c$$ = 0.1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`c$$, $CellContext`c$25425$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Plot[
        Sum[
         $CellContext`lagkern[$CellContext`t, $CellContext`k^2, \
$CellContext`c$$], {$CellContext`k, 1, 20}], {$CellContext`t, 0, 200}], 
      "Specifications" :> {{$CellContext`c$$, 0.1, 3, 0.1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{405., {148., 153.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.674449375424285*^9, 3.674449466889937*^9}, {
   3.6744495068295603`*^9, 3.6744495492725687`*^9}, 3.674449662496488*^9}]
}, Open  ]],

Cell[BoxData[
 StyleBox[
  RowBox[{"Maxwell", "-", 
   RowBox[{"type", " ", "kernel"}]}], "Chapter"]], "Input",
 CellChangeTimes->{{3.697766935871418*^9, 3.697766938369123*^9}}],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.6977669505356283`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxwellkern", "[", 
   RowBox[{"t_", ",", "\[Tau]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{"2", "/", "Pi"}], "]"}], "*", 
   RowBox[{
    RowBox[{"t", "^", "2"}], "/", 
    RowBox[{"(", 
     RowBox[{"\[Tau]", "^", "3"}], ")"}]}], "*", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"t", "^", "2"}]}], "/", 
     RowBox[{"(", 
      RowBox[{"2", "*", 
       RowBox[{"\[Tau]", "^", "2"}]}], ")"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"maxwellkern", "[", 
  RowBox[{"t", ",", " ", "\[Tau]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6977671390131283`*^9, 3.697767236186211*^9}, {
  3.697767373607594*^9, 3.6977674267644873`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox["t", "2"], 
      RowBox[{"2", " ", 
       SuperscriptBox["\[Tau]", "2"]}]]}]], " ", 
   SqrtBox[
    FractionBox["2", "\[Pi]"]], " ", 
   SuperscriptBox["t", "2"]}], 
  SuperscriptBox["\[Tau]", "3"]]], "Output",
 CellChangeTimes->{3.697767427255191*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{"maxwellkern", "[", 
    RowBox[{"s", ",", " ", "\[Tau]"}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"s", ",", "0", ",", "t"}], "}"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{
     RowBox[{"\[Tau]", ">", "0"}], "&&", " ", 
     RowBox[{"t", ">", "0"}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.697767253205915*^9, 3.697767306414503*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox["t", "2"], 
        RowBox[{"2", " ", 
         SuperscriptBox["\[Tau]", "2"]}]]}]], " ", 
     SqrtBox[
      FractionBox["2", "\[Pi]"]], " ", "t"}], "\[Tau]"]}], "+", 
  RowBox[{"Erf", "[", 
   FractionBox["t", 
    RowBox[{
     SqrtBox["2"], " ", "\[Tau]"}]], "]"}]}]], "Output",
 CellChangeTimes->{3.697767308363357*^9}]
}, Open  ]]
},
WindowSize->{1185, 782},
WindowMargins->{{Automatic, -600}, {33, Automatic}},
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 9, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 223, 3, 99, "Input"],
Cell[CellGroupData[{
Cell[806, 27, 654, 18, 28, "Input"],
Cell[1463, 47, 295, 8, 32, "Output"]
}, Open  ]],
Cell[1773, 58, 533, 17, 35, "Input"],
Cell[CellGroupData[{
Cell[2331, 79, 632, 15, 28, "Input"],
Cell[2966, 96, 1770, 36, 318, "Output"]
}, Open  ]],
Cell[4751, 135, 87, 1, 46, "Input"],
Cell[CellGroupData[{
Cell[4863, 140, 347, 11, 28, "Input"],
Cell[5213, 153, 194, 5, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5444, 163, 493, 13, 28, "Input"],
Cell[5940, 178, 137, 3, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6114, 186, 882, 24, 28, "Input"],
Cell[6999, 212, 137, 4, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7173, 221, 701, 19, 28, "Input"],
Cell[7877, 242, 1800, 36, 318, "Output"]
}, Open  ]],
Cell[9692, 281, 177, 4, 56, "Input"],
Cell[9872, 287, 89, 1, 46, "Input"],
Cell[CellGroupData[{
Cell[9986, 292, 729, 22, 46, "Input"],
Cell[10718, 316, 389, 13, 78, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11144, 334, 427, 11, 28, "Input"],
Cell[11574, 347, 497, 17, 115, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
